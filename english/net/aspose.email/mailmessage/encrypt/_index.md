---
title: Encrypt
second_title: Aspose.Email for .NET API Reference
description: Encrypts this message
type: docs
weight: 470
url: /net/aspose.email/mailmessage/encrypt/
---
## Encrypt(X509Certificate2) {#encrypt}

Encrypts this message

```csharp
public virtual MailMessage Encrypt(X509Certificate2 certificate)
```

| Parameter | Type | Description |
| --- | --- | --- |
| certificate | X509Certificate2 | X509 certificate to encrypt message |

### Return Value

Encrypted email message

### Examples

The following example shows how to encrypt Messages.

```csharp
[C#]

	// The path to the File directory.
	string dataDir = "PATH_TO_YOUR_DATA_DIRECTORY";

	string publicCertFile = dataDir + "MartinCertificate.cer";
	string privateCertFile = dataDir + "MartinCertificate.pfx";

	X509Certificate2 publicCert = new X509Certificate2(publicCertFile);
	X509Certificate2 privateCert = new X509Certificate2(privateCertFile, "anothertestaccount");

	// Create a message
	MailMessage msg = new MailMessage("atneostthaecrcount@gmail.com", "atneostthaecrcount@gmail.com", "Test subject", "Test Body");

	// Encrypt the message
	MailMessage eMsg = msg.Encrypt(publicCert);

	// Validate if the message is encrypted
	if (eMsg.IsEncrypted == true)
		Console.WriteLine("Its encrypted");
	else
		Console.WriteLine("It's NOT encrypted");
```

```csharp
[VB.NET]

	' The path to the File directory.
	Dim dataDir = "PATH_TO_YOUR_DATA_DIRECTORY"

	Dim publicCertFile = dataDir & "MartinCertificate.cer"
	Dim privateCertFile = dataDir & "MartinCertificate.pfx"

	Dim publicCert As X509Certificate2 = New X509Certificate2(publicCertFile)
	Dim privateCert As X509Certificate2 = New X509Certificate2(privateCertFile, "anothertestaccount")

	' Create a message
	Dim msg As MailMessage = New MailMessage("atneostthaecrcount@gmail.com", "atneostthaecrcount@gmail.com", "Test subject", "Test Body")

	' Encrypt the message
	Dim eMsg As MailMessage = msg.Encrypt(publicCert)

	' Validate if the message is encrypted
	If eMsg.IsEncrypted = True Then
		Console.WriteLine("Its encrypted")
	Else
		Console.WriteLine("It's NOT encrypted")
	End If
```

### See Also

* class [MailMessage](../../mailmessage)
* namespace [Aspose.Email](../../mailmessage)
* assembly [Aspose.Email](../../../)

---

## Encrypt(X509Certificate2[]) {#encrypt_1}

Encrypts this message

```csharp
public virtual MailMessage Encrypt(X509Certificate2[] certificates)
```

| Parameter | Type | Description |
| --- | --- | --- |
| certificates | X509Certificate2[] | Array with X509 certificates to encrypt message |

### Return Value

Encrypted email message

### See Also

* class [MailMessage](../../mailmessage)
* namespace [Aspose.Email](../../mailmessage)
* assembly [Aspose.Email](../../../)

<!-- DO NOT EDIT: generated by xmldocmd for Aspose.Email.dll -->
